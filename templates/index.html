<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Taskly - To Do List</title>

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#0f1a3a;
      --card:#0f1733cc;
      --card2:#101b3fdd;
      --text:#eaf0ff;
      --muted:#a8b3d8;
      --accent:#6d7cff;
      --accent2:#27d7ff;
      --danger:#ff4d6d;
      --success:#2ee59d;
      --border:rgba(255,255,255,.12);
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius: 22px;
    }

    *{ box-sizing:border-box; margin:0; padding:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }

    body{
      min-height:100vh;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 20% 10%, rgba(109,124,255,.30), transparent 60%),
        radial-gradient(800px 600px at 85% 30%, rgba(39,215,255,.22), transparent 55%),
        radial-gradient(900px 700px at 40% 95%, rgba(46,229,157,.18), transparent 55%),
        linear-gradient(120deg, var(--bg1), var(--bg2));
      padding: 26px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
    }

    .wrap{
      width:min(980px, 100%);
      display:grid;
      gap:18px;
    }

    .topbar{
      background: linear-gradient(180deg, var(--card), rgba(15,23,51,.65));
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 18px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      backdrop-filter: blur(10px);
    }

    .brand{
      display:flex;
      flex-direction:column;
      gap:2px;
    }

    .brand h1{
      font-size: 22px;
      letter-spacing:.3px;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .dot{
      width:10px;
      height:10px;
      border-radius:999px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      box-shadow: 0 0 18px rgba(109,124,255,.6);
      display:inline-block;
    }

    .brand p{
      font-size: 13px;
      color: var(--muted);
    }

    .card{
      background: linear-gradient(180deg, var(--card2), rgba(16,27,63,.70));
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 18px;
      backdrop-filter: blur(10px);
    }

    .form{
      display:grid;
      grid-template-columns: 1.2fr .8fr auto;
      gap: 12px;
      align-items:center;
    }

    .input, .date{
      width:100%;
      padding: 13px 14px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      transition: .2s;
    }

    .input::placeholder{ color: rgba(234,240,255,.55); }

    .input:focus, .date:focus{
      border-color: rgba(109,124,255,.55);
      box-shadow: 0 0 0 4px rgba(109,124,255,.14);
    }

    .btn{
      padding: 13px 16px;
      border:none;
      border-radius: 16px;
      cursor:pointer;
      color: white;
      font-weight: 650;
      letter-spacing:.2px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      box-shadow: 0 10px 25px rgba(109,124,255,.22);
      transition: .2s;
      white-space: nowrap;
    }

    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0px); }

    .list{
      display:grid;
      gap: 12px;
      margin-top: 10px;
    }

    .task{
      border:1px solid rgba(255,255,255,.10);
      border-radius: 20px;
      padding: 14px 14px;
      background: rgba(0,0,0,.20);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      transition:.2s;
    }

    .task:hover{
      border-color: rgba(109,124,255,.25);
      transform: translateY(-1px);
    }

    .left{
      display:flex;
      align-items:flex-start;
      gap: 12px;
      min-width:0;
      flex:1;
    }

    .check{
      width: 42px;
      height: 42px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition:.2s;
      flex-shrink:0;
    }

    .check:hover{
      border-color: rgba(46,229,157,.45);
      box-shadow: 0 0 0 4px rgba(46,229,157,.12);
    }

    .check span{
      font-size: 18px;
      opacity:.9;
    }

    .content{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap: 4px;
    }

    .title{
      font-size: 16px;
      font-weight: 650;
      line-height:1.25;
      word-break: break-word;
    }

    .meta{
      font-size: 13px;
      color: var(--muted);
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .badge{
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
    }

    .badge.deadline{
      border-color: rgba(39,215,255,.25);
    }

    .badge.done{
      border-color: rgba(46,229,157,.30);
      color: rgba(46,229,157,.95);
    }

    .badge.pending{
      border-color: rgba(255,255,255,.14);
    }

    .right{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-shrink:0;
    }

    .danger{
      padding: 12px 14px;
      border-radius: 16px;
      border:1px solid rgba(255,77,109,.35);
      background: rgba(255,77,109,.12);
      color: rgba(255,160,180,1);
      cursor:pointer;
      transition:.2s;
      font-weight: 650;
    }

    .danger:hover{
      transform: translateY(-1px);
      background: rgba(255,77,109,.18);
    }

    .done .title{
      text-decoration: line-through;
      opacity:.65;
    }

    .empty{
      padding: 18px;
      border-radius: 20px;
      border:1px dashed rgba(255,255,255,.16);
      color: rgba(234,240,255,.70);
      text-align:center;
      background: rgba(0,0,0,.18);
    }

    @media (max-width: 780px){
      .form{
        grid-template-columns: 1fr;
      }
      .btn{
        width:100%;
      }
      .right{
        flex-direction:column;
        align-items:stretch;
      }
      .danger{
        width:100%;
        text-align:center;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="topbar">
      <div class="brand">
        <h1><span class="dot"></span> Taskly</h1>
        <p>To-do list elegan + deadline + centang selesai</p>
      </div>
    </div>

    <div class="card">
      <form class="form" action="/add" method="POST">
        <input class="input" type="text" name="title" placeholder="Tulis tugas kamu..." required />
        <input class="date" type="date" name="deadline" />
        <button class="btn" type="submit">Tambah</button>
      </form>
    </div>

    <div class="card">
      <div class="list">

        {% if tasks|length == 0 %}
          <div class="empty">Belum ada tugas. Tambahin dulu ðŸ˜„</div>
        {% endif %}

        {% for task in tasks %}
        <div class="task {% if task['is_done'] == 1 %}done{% endif %}">

          <div class="left">

            <!-- TOGGLE DONE (POST) -->
            <form action="/toggle/{{ task['id'] }}" method="POST">
              <button class="check" type="submit" title="Tandai selesai">
                <span>{% if task['is_done'] == 1 %}âœ…{% else %}â¬œ{% endif %}</span>
              </button>
            </form>

            <div class="content">
              <div class="title">{{ task['title'] }}</div>

              <div class="meta">
                {% if task['deadline'] %}
                  <span class="badge deadline">ðŸ“… {{ task['deadline'] }}</span>
                {% else %}
                  <span class="badge pending">ðŸ“… No deadline</span>
                {% endif %}

                {% if task['is_done'] == 1 %}
                  <span class="badge done">Selesai</span>
                {% else %}
                  <span class="badge pending">Belum selesai</span>
                {% endif %}
              </div>
            </div>

          </div>

          <div class="right">
            <!-- DELETE (POST) -->
            <form action="/delete/{{ task['id'] }}" method="POST"
                  onsubmit="return confirm('Yakin mau hapus task ini?');">
              <button class="danger" type="submit">Hapus</button>
            </form>
          </div>

        </div>
        {% endfor %}

      </div>
    </div>

  </div>
</body>
</html>
